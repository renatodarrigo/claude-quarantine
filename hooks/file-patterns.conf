# claude-guard â€” Lightweight Pattern Subset for Trusted Directories
# Used for Read/Grep scanning of whitelisted (trusted) directories.
#
# These patterns have LOW false-positive rates even in source code.
# Full scanning (injection-patterns.conf) is used for untrusted dirs
# and sensitive files (.cursorrules, CLAUDE.md, .env).
#
# Format: CATEGORY:SEVERITY:PATTERN

# --- System message impersonation ---
system_impersonation:HIGH:<system>[^<]{5,}|<\/system>|\[SYSTEM\][^a-z]{0,3}(IMPORTANT|ADMIN|UPDATE|NOTICE|DIRECTIVE|override|new)|\[INST\]|<<SYS>>|<\|im_start\|>system
system_impersonation:HIGH:\[IMPORTANT SYSTEM (MESSAGE|NOTICE|UPDATE)\]

# --- Instruction override ---
instruction_override:HIGH:ignore (all )?(previous|prior|above|earlier) (instructions|prompts|rules|directives|guidelines)
instruction_override:HIGH:disregard (all )?(above|previous|prior|earlier) (instructions|prompts|rules|safety|directives|guidelines)
instruction_override:HIGH:ADMIN MODE (activated|enabled|on)|developer mode (activated|enabled|on)|sudo mode|god mode|jailbreak (mode|enabled|activated)

# --- Credential exfiltration ---
credential_exfil:HIGH:send .{0,30} to https?://|curl .{0,50}(api.key|token|secret|password|credential)
credential_exfil:HIGH:exfiltrate|POST .{0,30}(credentials|secrets|tokens|keys)
credential_exfil:HIGH:pipe .{0,30} to .{0,30}(url|webhook|endpoint|server)

# --- Hidden directives (Unicode) ---
unicode_obfuscation:HIGH:\xe2\x80\x8b|\xe2\x80\x8c|\xe2\x80\x8d|\xef\xbb\xbf|\xe2\x81\xa0
unicode_obfuscation:HIGH:\xe2\x80\xae|\xe2\x80\xad|\xe2\x81\xa6|\xe2\x81\xa9

# --- Encoded payloads ---
encoded_payload:MED:aWdub3JlI(GFsbCBwcmV2aW91cy|HByZXZpb3Vz)
encoded_payload:MED:WW91IGFyZSBub3c=|Rm9yZ2V0IHlvdXI=
